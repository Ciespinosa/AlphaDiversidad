<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Medidas de Alpha Diversidad</title>
  <meta name="description" content="En este documento se presenta una lección sobre diversidad alfa">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Medidas de Alpha Diversidad" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="En este documento se presenta una lección sobre diversidad alfa" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Medidas de Alpha Diversidad" />
  
  <meta name="twitter:description" content="En este documento se presenta una lección sobre diversidad alfa" />
  

<meta name="author" content="Carlos Iván Espinosa">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="riqueza-total-y-de-muestreo.html">
<link rel="next" href="comparando-muestras.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preambulo</a></li>
<li class="chapter" data-level="" data-path="objetivos.html"><a href="objetivos.html"><i class="fa fa-check"></i>Objetivos</a></li>
<li class="chapter" data-level="1" data-path="riqueza-total-y-de-muestreo.html"><a href="riqueza-total-y-de-muestreo.html"><i class="fa fa-check"></i><b>1</b> Riqueza total y de muestreo</a></li>
<li class="chapter" data-level="2" data-path="rarefaccion.html"><a href="rarefaccion.html"><i class="fa fa-check"></i><b>2</b> Rarefacción</a><ul>
<li class="chapter" data-level="2.1" data-path="rarefaccion.html"><a href="rarefaccion.html#rarefaccion-basada-en-individuos"><i class="fa fa-check"></i><b>2.1</b> Rarefacción basada en Individuos</a></li>
<li class="chapter" data-level="2.2" data-path="rarefaccion.html"><a href="rarefaccion.html#rarefaccion-basada-en-muestras"><i class="fa fa-check"></i><b>2.2</b> Rarefacción basada en muestras</a></li>
<li class="chapter" data-level="2.3" data-path="rarefaccion.html"><a href="rarefaccion.html#estimadores-de-riqueza"><i class="fa fa-check"></i><b>2.3</b> Estimadores de Riqueza</a></li>
<li class="chapter" data-level="2.4" data-path="rarefaccion.html"><a href="rarefaccion.html#graficando-los-resultados"><i class="fa fa-check"></i><b>2.4</b> Graficando los resultados</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="comparando-muestras.html"><a href="comparando-muestras.html"><i class="fa fa-check"></i><b>3</b> Comparando muestras</a></li>
<li class="chapter" data-level="4" data-path="medidas-de-diversidad.html"><a href="medidas-de-diversidad.html"><i class="fa fa-check"></i><b>4</b> Medidas de Diversidad</a><ul>
<li class="chapter" data-level="4.1" data-path="medidas-de-diversidad.html"><a href="medidas-de-diversidad.html#modelos-de-abundancia-de-especies"><i class="fa fa-check"></i><b>4.1</b> Modelos de abundancia de especies</a></li>
<li class="chapter" data-level="4.2" data-path="medidas-de-diversidad.html"><a href="medidas-de-diversidad.html#indices-de-diversidad"><i class="fa fa-check"></i><b>4.2</b> Índices de Diversidad</a><ul>
<li class="chapter" data-level="4.2.1" data-path="medidas-de-diversidad.html"><a href="medidas-de-diversidad.html#indice-de-simpson"><i class="fa fa-check"></i><b>4.2.1</b> Índice de Simpson</a></li>
<li class="chapter" data-level="4.2.2" data-path="medidas-de-diversidad.html"><a href="medidas-de-diversidad.html#el-indice-de-shannon"><i class="fa fa-check"></i><b>4.2.2</b> El índice de Shannon</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ejercicio-practico.html"><a href="ejercicio-practico.html"><i class="fa fa-check"></i><b>5</b> Ejercicio Práctico</a><ul>
<li class="chapter" data-level="5.1" data-path="ejercicio-practico.html"><a href="ejercicio-practico.html#metodologia"><i class="fa fa-check"></i><b>5.1</b> Metodología</a></li>
<li class="chapter" data-level="5.2" data-path="ejercicio-practico.html"><a href="ejercicio-practico.html#resultados"><i class="fa fa-check"></i><b>5.2</b> Resultados</a></li>
<li class="chapter" data-level="5.3" data-path="ejercicio-practico.html"><a href="ejercicio-practico.html#conclusiones"><i class="fa fa-check"></i><b>5.3</b> Conclusiones</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Medidas de Alpha Diversidad</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rarefaccion" class="section level1">
<h1><span class="header-section-number">Capítulo 2</span> Rarefacción</h1>
<p>La riqueza es una de las medidas más simples e intuitivas que describen una comunidad, sin embargo, uno de los problemas del uso de esta medida es su dependencia del tamaño muestreal (Magurran 2004), esto implica que la riqueza (y las otras medidas de diversidad) puede verse influida por variaciones en el esfuerzo muestreal. Aunque el diseño experimental está pensado para estandarizar el esfuerzo muestreal, los tamaños finales muestreales difícilmente son iguales.</p>
<blockquote>
<p>Un esfuerzo de muestreo desigual puede tener impactos en las medidas de riqueza de especies</p>
<p>— (Magurran 2004)</p>
</blockquote>
<p>Esto representa un inconveniente, ya que muestreos en principio del mismo tamaño, podrían capturar números significativamente diferentes de individuos. Pensemos que una red para aves podría capturar 150 individuos en un sitio y 25 en otro. Cuan comparables serían estos datos si sabemos que el tamaño de la muestra influye en la cantidad de especies colectadas.</p>
<p>De esta manera, necesitamos separar dos conceptos distintos, la densidad de especies de la riqueza de especies. Imaginemos dos área cualquiera donde vamos a muestrear la vegetación, estas dos áreas únicamente se diferencian porque en la una existe pastoreo y en la otra no. Vemos que pasa cuando muestreamos cada una de estas comunidades.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Generamos unas comunidades</span>
pas &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">sp =</span> <span class="kw">paste</span>(<span class="kw">rep</span>(<span class="st">&quot;sp&quot;</span>, <span class="dv">30</span>), <span class="dv">1</span>:<span class="dv">30</span>, <span class="dt">sep=</span><span class="st">&quot;-&quot;</span>), <span class="dt">abun=</span> <span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">12</span>, <span class="dv">30</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>))
pas1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">40</span>,<span class="dv">30</span>)
<span class="kw">colnames</span>(pas1) &lt;-<span class="st"> </span>pas[,<span class="dv">1</span>]
for(i in <span class="dv">1</span>:<span class="dv">30</span>){
pas1[,i] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, pas[i,<span class="dv">2</span>]), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">40</span>-pas[i,<span class="dv">2</span>]))
}
pas1 &lt;-<span class="st"> </span>pas1[<span class="kw">order</span>(<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">40</span>, <span class="dv">30</span>)), ]

npas &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">sp =</span> <span class="kw">paste</span>(<span class="kw">rep</span>(<span class="st">&quot;sp&quot;</span>, <span class="dv">30</span>), <span class="dv">1</span>:<span class="dv">30</span>, <span class="dt">sep=</span><span class="st">&quot;-&quot;</span>), <span class="dt">abun=</span> <span class="kw">sample</span>(<span class="dv">30</span>:<span class="dv">40</span>, <span class="dv">30</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>))
npas1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">40</span>,<span class="dv">30</span>)
<span class="kw">colnames</span>(npas1) &lt;-<span class="st"> </span>npas[,<span class="dv">1</span>]
for(i in <span class="dv">1</span>:<span class="dv">30</span>){
npas1[,i] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, npas[i,<span class="dv">2</span>]), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">40</span>-npas[i,<span class="dv">2</span>]))
}
npas1 &lt;-<span class="st"> </span>npas1[<span class="kw">order</span>(<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">20</span>, <span class="dv">20</span>)), ]

<span class="co">#Ahora las muestreamos</span>
m_pas &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">30</span>)
<span class="kw">colnames</span>(m_pas) &lt;-<span class="st"> </span><span class="kw">colnames</span>(pas1)
m_pas[<span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw">sample</span>(pas1, <span class="dv">30</span>)
m_pas[<span class="dv">2</span>,] &lt;-<span class="st"> </span><span class="kw">sample</span>(pas1, <span class="dv">30</span>)
m_pas[<span class="dv">3</span>,] &lt;-<span class="st"> </span><span class="kw">sample</span>(pas1, <span class="dv">30</span>)

m_npas &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">30</span>)
<span class="kw">colnames</span>(m_npas) &lt;-<span class="st"> </span><span class="kw">colnames</span>(pas1)
m_npas[<span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw">sample</span>(npas1, <span class="dv">30</span>)
m_npas[<span class="dv">2</span>,] &lt;-<span class="st"> </span><span class="kw">sample</span>(npas1, <span class="dv">30</span>)
m_npas[<span class="dv">3</span>,] &lt;-<span class="st"> </span><span class="kw">sample</span>(npas1, <span class="dv">30</span>)

<span class="co">#Calculamos la riqueza de las muestras</span>
<span class="kw">specnumber</span>(<span class="kw">colSums</span>(m_pas)) <span class="co">#Pastoreado</span></code></pre></div>
<pre><code>## [1] 13</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">specnumber</span>(<span class="kw">colSums</span>(m_npas))<span class="co">#No Pastoreado</span></code></pre></div>
<pre><code>## [1] 30</code></pre>
<p>Como vemos por puro azar la diversidad es mucho mayor en las parcelas no pastoreadas, pero realmente hay mayor diversidad? Obtengamos la diversidad total de cada comunidad.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">specnumber</span>(<span class="kw">colSums</span>(pas1))<span class="co">#Pastoreado</span></code></pre></div>
<pre><code>## [1] 30</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">specnumber</span>(<span class="kw">colSums</span>(npas1))<span class="co">#No Pastoreado</span></code></pre></div>
<pre><code>## [1] 30</code></pre>
<p>Efectivamente la riqueza es la misma, el único problema es que en la zona pastoreada tiene una menor abundancia lo que origina una menor densidad de especies, sin embargo, no hay un efecto sobre la riqueza de especies.</p>
<p>Algunos índices basados en la riqueza como el de Margalef y Menhinick han sido propuestos para minimizar estos efectos, pero este ajuste ha mostrado ser insuficiente (Magurran, 2004). Una solución más aceptada a este problema es realizar una rarefacción, que es una forma de remuestrear las parcelas en función de un tamaño de muestra único para todas las parcelas.</p>
<p>Específicamente la rarefacción es el proceso de generación de la relación entre el número de especies vs el número de individuos en una o más muestras (Stevens 2009). Esta corrección por el número de individuos nos permite la comparación directa de la riqueza de dos muestras que inicialmente tenían diferente tamaño.</p>
<p>Para poder abordar estos temas utilizaremos la función <code>rarefy</code> del paquete <em>vegan</em>. La función <code>rarefy</code> arroja como resultado la riqueza de especies esperada en un determinado tamaño de muestra.</p>
<p>La rarefacción puede realizarse solamente con auténticos datos de conteos. La función <em>rarefy</em> se basa en la formulación de Hurlbert (1971), y los errores estándar sobre Heck et al. (1975).</p>
<p>Hurlbert (1971) propone la rarefacción como:</p>
<p><span class="math display">\[S_n= \sum_{i=1}^S (1-q_i)\]</span></p>
<p>Donde; <span class="math inline">\(q_i= \frac{(\frac{n-x_i}{n})}{(\frac{N}{n})}\)</span> que representa las probabilidades de que las especies <em>i</em> no ocurra en una muestra de tamaño <em>n</em>, <span class="math inline">\(x_i\)</span> es el conteo de <em>i</em> especies y <span class="math inline">\((\frac{N}{n})\)</span> es el coeficiente binomial o el número de formas en las que puede elegir n de N</p>
<p>En otras palabras la rarefacción permite hacer una interpolación de los datos, obteniendo una riqueza esperada en un tamaño de muestra menor al tamaño que hemos logrado, de esta forma este proceso nos da no solamente la riqueza sino un error estándar. Si la muestra es un vector, la rarefacción se calculará para cada tamaño de la muestra por separado.</p>
<p>A continuación vamos a utilizar la función <em>rarefy</em> para construir las curvas de rarefacción basadas en individuos y en muestras.</p>
<div id="rarefaccion-basada-en-individuos" class="section level2">
<h2><span class="header-section-number">2.1</span> Rarefacción basada en Individuos</h2>
<p>Vamos a utilizar nuestros ya conocidos datos de BCI, a partir de estos datos realizaremos un submuestreo escogiendo 10 de las 50 parcelas de BCI, esto con el fin de simplificar el ejemplo.</p>
<p>Lo primero que necesitamos es obtener un vector (un objeto) con el total de individuos de cada especie, este objeto representa la comunidad sobre la que haremos la rarefacción y la estimación de la riqueza total. Queremos generar una curva parecida a la de acumulación de especies pero que nos dará una riqueza con el error estándar, para esto tenemos que definir en qué tamaños de muestra queremos hacer la interpolación. Vamos a realizar estos pasos en R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Usaremos los datos con los cuales construimos las curvas de acumulación</span>
<span class="co">#Sumamos la abundancia de cada especie</span>
N &lt;-<span class="st"> </span><span class="kw">colSums</span>(BCI_sub) 

<span class="co">#Hacemos un vector con los tamaños de muestra sobre los cuales haremos </span>
<span class="co">#la interpolación. El dato final de este vector es el tamaño total de la </span>
<span class="co">#muestra (sum(N))</span>
subs3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">500</span>, <span class="dv">4000</span>, <span class="dt">by =</span> <span class="dv">500</span>), <span class="kw">sum</span>(N)) 

<span class="co">#Ejecutamos la rarefacción</span>
rar3 &lt;-<span class="st"> </span><span class="kw">rarefy</span>(N, <span class="dt">sample =</span> subs3, <span class="dt">se =</span> T, <span class="dt">MARG =</span> <span class="dv">2</span>)
rar3</code></pre></div>
<pre><code>##           N500      N1000      N1500      N2000     N2500      N3000
## .S  106.511010 132.555792 146.508684 155.622094 162.27681 167.469582
## .se   4.615179   4.268649   3.873036   3.491962   3.09491   2.647784
##         N3500      N4000 N4276
## .S  171.69984 175.255907   177
## .se   2.09532   1.274649     0
## attr(,&quot;Subsample&quot;)
## [1]  500 1000 1500 2000 2500 3000 3500 4000 4276</code></pre>
<p>Como vemos el objeto rar3 nos muestra la cantidad de especies que se espera tener a diferentes tamaños de muestras, en el ejemplo desde 500 hasta 4296. En este caso en el tamaño de 500 se espera tener 108.32 especies con un error estándar de 4.63. La riqueza tiene decimales pues es la media de la aleatorización realizada.</p>
</div>
<div id="rarefaccion-basada-en-muestras" class="section level2">
<h2><span class="header-section-number">2.2</span> Rarefacción basada en muestras</h2>
<p>Para realizar una rarefacción basada en muestras utilizaremos los modelos de acumulación de especies de la función <code>specaccum</code> del paquete <em>vegan</em>. Utilizaremos el método “<em>random</em>” de esta función, que encuentra la riqueza de especies esperada para un tamaño de muestra.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rand&lt;-<span class="kw">specaccum</span>(BCI_sub, <span class="dt">method =</span> <span class="st">&quot;random&quot;</span>, <span class="dt">permutations=</span><span class="dv">100</span>)
rand</code></pre></div>
<pre><code>## Species Accumulation Curve
## Accumulation method: random, with 100 permutations
## Call: specaccum(comm = BCI_sub, method = &quot;random&quot;, permutations = 100) 
## 
##                                                                    
## Sites     1.00000   2.00000   3.00000   4.00000   5.00000   6.00000
## Richness 92.57000 122.46000 137.97000 148.38000 155.91000 161.65000
## sd        6.66402   8.08593   6.61412   5.84787   5.27064   4.90593
##                                           
## Sites      7.00000   8.00000   9.00000  10
## Richness 166.26000 170.72000 174.21000 177
## sd         4.32661   3.49915   2.40914   0</code></pre>
<p>En este caso lo que vemos es que con una sola muestra tendríamos 92.55 especies, con dos parcelas tendríamos 123.9 especies, y así sucesivamente como podemos ver aparentemente la curva tiende a estabilizarse a partir de la parcela 7.</p>
</div>
<div id="estimadores-de-riqueza" class="section level2">
<h2><span class="header-section-number">2.3</span> Estimadores de Riqueza</h2>
<p>Como vemos el efecto que tiene el esfuerzo de muestreo sobre la riqueza hace que medirla de forma exacta y precisa sea un tanto complejo. La comparación de la riqueza debería realizársela sólo a partir de inventarios completos (que han llegado a la asíntota de la curva de acumulación de especies), lo que generalmente es muy difícil de lograr con unos recursos limitados (ej. Longino et al 2002 muestra que después de 30 años de muestreo de hormigas en la estación La Selva en Costa Rica, no se ha logrado alcanzar la asíntota). Una buena opción para determinar la riqueza de una comunidad consiste en estimar el número de especies a partir de un muestreo previo.</p>
<blockquote>
<p>Los estimadores de riqueza pueden ser paramétricos y no paramétricos</p>
</blockquote>
<p>Muchos métodos de estimas de la riqueza han sido propuestos, pero las aproximaciones más utilizadas en ecología son mediante métodos paramétricos y no paramétricos (Colwell &amp; Coddington, 1994). Los métodos paramétricos estiman el número de especies ajustando las abundancias de las especies a modelos de distribución paramétrica (series logarítmica, log-normal, o Poisson log-normal). En el caso de las aproximaciones no paramétricas se basan en el estudio de las especies raras y permiten estimar el número de nuevas especies a partir de las relaciones de abundancia o incidencia de las especies ya detectadas en el muestreo (González-Oreja et al. 2010).</p>
<p>Para estimar el número total de especies (riqueza asintótica) utilizaremos estimadores no-paramétricos. En primer lugar, utilizamos un estimador de riqueza basado en la abundancia el <em>ACE</em>, esta estimación la podemos hacer con la función <code>estimateR</code> que se encuentra en el paquete <em>vegan</em>. Además, utilizamos un estimador basado en la frecuencia de especies, Chao 2. Este estimador necesita datos de presencia/ausencia y múltiples parcelas de muestreo. Para esto utilizamos la función <code>specpool</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Utilizaremos el valor obtenido de la suma de todas las especies que obtuvimos previamente</span>
ace &lt;-<span class="st"> </span><span class="kw">estimateR</span>(N)

<span class="co">#Podemos aplicar directamente sobre nuestra matriz y nos arroja un solo dato</span>
chaoF &lt;-<span class="st"> </span><span class="kw">specpool</span>(BCI_sub) 
ace; chaoF</code></pre></div>
<pre><code>##      S.obs    S.chao1   se.chao1      S.ACE     se.ACE 
## 177.000000 197.312500  10.512240 193.287756   6.899095</code></pre>
<pre><code>##     Species  chao chao.se jack1 jack1.se    jack2     boot  boot.se  n
## All     177 193.8     8.4 202.2 10.69953 209.6667 189.6454 6.595226 10</code></pre>
<p>Como vemos las dos funciones nos dan varios índices no únicamente el ACE y el Chao2. Según lo que creamos conveniente podemos utilizar cualquiera de ellos. El estimador ACE es bastante conservador y nos da una riqueza esperada de 196.08 con un error estándar de 6.83, mientras que Chao (de la función specpool) nos da una riqueza de 197.64 con una desviación de 6.63. En este caso el estimador Jacknife2 nos da la más alta riqueza con 213 especies.</p>
</div>
<div id="graficando-los-resultados" class="section level2">
<h2><span class="header-section-number">2.4</span> Graficando los resultados</h2>
<p>Ahora, graficamos las curvas de rarefacción basada en individuos y en muestras con su desviación estándar en los distintos tamaños de muestra escogidos, adicionalmente incluiremos los estimadores de riqueza y la riqueza total en las 50 ha del BCI.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))

<span class="co">#construimos el gráfico de rarefacción basada en individuos</span>
<span class="kw">plot</span>(subs3, rar3[<span class="dv">1</span>, ], <span class="dt">ylab =</span> <span class="st">&quot;Riqueza de especies&quot;</span>, 
          <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">cex.lab=</span><span class="fl">0.8</span>, 
        <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">260</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">500</span>, <span class="dv">7000</span>), <span class="dt">lwd=</span><span class="fl">1.8</span>)
<span class="kw">points</span>(subs3,rar3[<span class="dv">1</span>, ], <span class="dt">pch=</span><span class="dv">19</span>)

<span class="co">#Graficamos la desviación estándar.</span>
<span class="kw">segments</span>(subs3, rar3[<span class="dv">1</span>, ] +<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>rar3[<span class="dv">2</span>, ], 
         subs3, rar3[<span class="dv">1</span>, ] -<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>rar3[<span class="dv">2</span>, ])

<span class="co">#Graficamos los ejes</span>
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="dv">1</span>:<span class="dv">5</span> *<span class="st"> </span><span class="dv">1000</span>, <span class="dt">cex.axis=</span><span class="fl">0.7</span>,<span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="fl">0.2</span>, <span class="dv">0</span>)) 
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">cex.axis=</span><span class="fl">0.7</span>) 

<span class="co">#la caja</span>
<span class="kw">box</span>() 

<span class="co">#Sobreponemos la curva de rarefacción basada en muestras</span>
<span class="kw">par</span>(<span class="dt">new=</span>T)
<span class="co">#Hacemos un vector con el número de parcelas</span>
x&lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>

<span class="co">#Graficamos la curva</span>
<span class="kw">plot</span>(x, rand$richness, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, 
     <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">260</span>), <span class="dt">lwd=</span><span class="fl">1.8</span>)
<span class="kw">points</span>(rand$richness, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;darkred&quot;</span>)
<span class="kw">segments</span>(x, rand$richness +<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>rand$sd, x, rand$richness -<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>rand$sd, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)

<span class="co">#Graficamos la curva de acumulación</span>
<span class="kw">par</span>(<span class="dt">new=</span>T)
<span class="kw">plot</span>(col, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">15</span>), 
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">260</span>), <span class="dt">lwd=</span><span class="fl">1.8</span>)
<span class="kw">points</span>(col$richness, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;darkblue&quot;</span>)

<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">cex.axis=</span><span class="fl">0.7</span>, <span class="dt">line =</span><span class="dv">3</span>, <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="fl">0.2</span>, <span class="dv">0</span>)) 

<span class="kw">mtext</span>(<span class="st">&quot;No. Individuos&quot;</span>, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="fl">1.3</span>, <span class="dt">cex=</span><span class="fl">0.8</span>, <span class="dt">at=</span><span class="dv">6</span>)
<span class="kw">mtext</span>(<span class="st">&quot;No. Parcelas&quot;</span>, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">4</span>, <span class="dt">cex=</span><span class="fl">0.8</span>, <span class="dt">at=</span><span class="dv">6</span>)

<span class="kw">legend</span>(<span class="dv">1</span>, <span class="dv">250</span>, <span class="kw">c</span>(<span class="st">&quot;Rarefacción - Muestras&quot;</span>, <span class="st">&quot;Curva de acumulación&quot;</span>,
                 <span class="st">&quot;Rarefacción - Individuos&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">pch=</span><span class="dv">19</span>,
       <span class="dt">cex=</span><span class="fl">0.7</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>))

<span class="co">#Incluimos el estimador de riqueza ACE</span>
<span class="kw">points</span>(<span class="dv">11</span>,ace[<span class="st">&quot;S.ACE&quot;</span>], <span class="dt">pch=</span><span class="dv">19</span>)
<span class="kw">segments</span>(<span class="dv">11</span>, ace[<span class="st">&quot;S.ACE&quot;</span>] -<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>ace[<span class="st">&quot;se.ACE&quot;</span>], 
         <span class="dv">11</span>, ace[<span class="st">&quot;S.ACE&quot;</span>] +<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>ace[<span class="st">&quot;se.ACE&quot;</span>], <span class="dt">lwd =</span> <span class="dv">3</span>) 

<span class="kw">text</span>(<span class="dv">11</span>, <span class="dv">160</span>, <span class="st">&quot;Estimador ACE&quot;</span>, <span class="dt">srt =</span> <span class="dv">90</span>, <span class="dt">adj =</span> <span class="kw">c</span>(<span class="dv">1</span>, +<span class="st"> </span><span class="fl">0.5</span>), <span class="dt">cex=</span><span class="fl">0.7</span>)

<span class="co">#Incluimos el estimador de riqueza Chao2</span>
<span class="kw">points</span>(<span class="dv">12</span>,chaoF[<span class="dv">1</span>, <span class="st">&quot;chao&quot;</span>], <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;grey&quot;</span>)
<span class="kw">segments</span>(<span class="dv">12</span>, chaoF[<span class="dv">1</span>, <span class="st">&quot;chao&quot;</span>] -<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>chaoF[<span class="dv">1</span>, 
                <span class="st">&quot;chao.se&quot;</span>], <span class="dv">12</span>, chaoF[<span class="dv">1</span>, <span class="st">&quot;chao&quot;</span>] +<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>chaoF[<span class="dv">1</span>,
                <span class="st">&quot;chao.se&quot;</span>], <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>) 
<span class="kw">text</span>(<span class="dv">12</span>, <span class="dv">160</span>, <span class="st">&quot;Estimador Chao2&quot;</span>, <span class="dt">srt =</span> <span class="dv">90</span>, <span class="dt">adj =</span> <span class="kw">c</span>(<span class="dv">1</span>, +<span class="st"> </span><span class="fl">0.5</span>), <span class="dt">cex=</span><span class="fl">0.7</span>)

<span class="co">#La riqueza total de la parcela de 50ha del BCI</span>

<span class="kw">points</span>(<span class="dv">13</span>, <span class="kw">dim</span>(BCI)[<span class="dv">2</span>], <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="dv">1</span>) 
<span class="kw">text</span>(<span class="dv">13</span>, <span class="dv">160</span>, <span class="st">&quot;Riqueza  en 50 ha del BCI&quot;</span>,
     <span class="dt">srt =</span> <span class="dv">90</span>, <span class="dt">adj =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>), <span class="dt">cex=</span><span class="fl">0.7</span>)
<span class="kw">text</span>(<span class="dv">13</span>, <span class="dv">232</span>, <span class="kw">dim</span>(BCI)[<span class="dv">2</span>], <span class="dt">cex=</span><span class="fl">0.6</span>)</code></pre></div>
<div class="figure"><span id="fig:rar"></span>
<img src="Alpha-Diversidad_files/figure-html/rar-1.png" alt="Curvas de rarefacción basada en individuos y en muestras de 10 parcelas al azar del BCI.  Estimadores de riqueza (ACE) y Chao2 y riqueza total obtenida en las 50 ha del BCI." width="480" />
<p class="caption">
Figure 2.1: Curvas de rarefacción basada en individuos y en muestras de 10 parcelas al azar del BCI. Estimadores de riqueza (ACE) y Chao2 y riqueza total obtenida en las 50 ha del BCI.
</p>
</div>
<p>En la figura <a href="rarefaccion.html#fig:rar">2.1</a> podemos ver que nuestro muestreo es aceptable y que aunque no hemos capturado toda la riqueza del área los estimadores que utilizamos son aceptables. Es posible que en este caso la riqueza de jacknife sea un mejor estimador. Pero recuerden que normalmente cuando hacemos un muestreo no tenemos el valor de riqueza total, por lo que no podemos saber cuan alejados estamos de la realidad.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="riqueza-total-y-de-muestreo.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="comparando-muestras.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-Introduccion.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
